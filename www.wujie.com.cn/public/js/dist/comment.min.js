function getComment(a,s,n,e){if("live"==n?(e?($("#commentflag").data("maxid",a.max_id),$("#commentflag").data("minid",a.min_id)):$("#commentflag").data("minid",a.min_id),a.all_count>0&&($("#allComment").show(),a.all_count>10&&($("#scroller").css("paddingBottom","4rem"),$("#morecm").removeClass("none")))):"activity"==n?(e?($("#commentflag").data("maxid",a.max_id),$("#commentflag").data("minid",a.min_id)):$("#commentflag").data("minid",a.min_id),$("#plun").html(a.all_count+"次"),$("#commentnum").html(a.all_count),a.all_count>0?($("#nocommenttip").hide(),a.all_count>8&&$("#morecm").removeClass("none")):$("#nocommenttip").show()):($(".amazeComment .num").html(a.amaze_count),$(".allComment .num").html(a.all_count),a.amaze_count>0?$(".amazeComment,#amazeComment").show():$(".amazeComment,#amazeComment").hide(),a.all_count>0?($(".allComment,#allComment").show(),$("#nocommenttip").hide(),a.all_count>10&&($("#scroller").css("paddingBottom","4rem"),$("#morecm").removeClass("none"))):($(".allComment,#allComment").hide(),$("#nocommenttip").show())),a.data.length>0){a.data.length<s&&($("#scroller").css("paddingBottom","0"),$("#morecm").addClass("none"));var t="",i="";$.each(a.data,function(a,s){if("amaze"==s.type)"normal"==s.form?(t+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',t+='<dt><img alt="" src="'+s.avatar+'"></dt>',t+='<dd class="contentDd">',t+='<p class="name">'+s.c_nickname+"</p>",null==s.pId?(t+='<p class="comment">'+entitiestoUtf16(s.content)+"</p>",s.images.length>0&&(t+='<div class="pics">',$.each(s.images,function(a,s){t+='<img src="'+s+'" alt="" class="onimgs" data-picindex="'+a+'">'}),t+="</div>")):(t+='<p class="comment">回复<span class="blue">@'+s.p_nickname+"</span>:"+s.content+"</p>",t+='<div class="original">',"0"==s.pStatus?t+="<p>评论已删除</p>":(t+="<p>"+s.p_nickname+":"+entitiestoUtf16(s.pContent)+"</p>",s.pImages.length>0&&(t+='<div class="pics">',$.each(s.pImages,function(a,s){t+='<img src="'+s+'" alt="" class="onimgs" data-picindex="'+a+'">'}),t+="</div>")),t+="</div>"),t+="</dd>",t+="<dd>",t+='<p class="intro"><span class="l">'+s.created_at+"</span>",t+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",t+="</p>",t+="</dd>",t+='<div id="tips" class="coperate">',s.c_uid==labUser.uid?(t+='<div class="content"></span><span class="delete">删除</span></div>',t+='<div class="arrow_down"></div>'):(t+='<div class="content"><span class="reply">回复</span></div>',t+='<div class="arrow_down"></div>'),t+="</div>",t+='<div class="clearfix"></div>',t+="</dl>"):"flower"==s.form?(t+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',t+='<dt><img alt="" src="'+s.avatar+'"></dt>',t+='<dd  class="contentDd">',t+='<p class="name">'+s.c_nickname+"</p>",t+='<p class="comment">'+s.content+"</p>",t+="</dd>",t+="<dd>",t+='<p class="intro"><span class="l">'+s.created_at+"</span>",t+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",t+="</p>",t+="</dd>",t+='<div class="clearfix"></div>',t+="</dl>"):"reward"==s.form&&(t+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',t+='<dt><img alt="" src="'+s.avatar+'"></dt>',t+='<dd  class="contentDd">',t+='<p class="name">'+s.c_nickname+"</p>",t+='<div class="comment reward">'+s.content+'<span class="awardflag"></span></div>',t+="</dd>",t+="<dd>",t+='<p class="intro"><span class="l">'+s.created_at+"</span>",t+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",t+="</p>",t+="</dd>",t+='<div class="clearfix"></div>',t+="</dl>");else if("all"==s.type)if("normal"==s.form)i+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',i+='<dt><img alt="" src="'+s.avatar+'"></dt>',i+='<dd  class="contentDd">',i+='<p class="name">'+s.c_nickname+"</p>",null==s.pId?(i+='<p class="comment">'+entitiestoUtf16(s.content)+"</p>",s.images.length>0&&(i+='<div class="pics">',$.each(s.images,function(a,s){i+='<img src="'+s+'" alt="" class="onimgs" data-picindex="'+a+'">'}),i+="</div>")):(i+='<p class="comment">回复<span class="blue">@'+s.p_nickname+"</span>:"+entitiestoUtf16(s.content)+"</p>",i+='<div class="original">',"0"==s.pStatus?i+="<p>评论已删除</p>":(i+="<p>"+s.p_nickname+":"+entitiestoUtf16(s.pContent)+"</p>",s.pImages.length>0&&(i+='<div class="pics">',$.each(s.pImages,function(a,s){i+='<img src="'+s+'" alt="" class="onimgs" data-picindex="'+a+'">'}),i+="</div>")),i+="</div>"),i+="</dd>",i+="<dd>",i+='<p class="intro"><span class="l">'+s.created_at+"</span>",i+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",i+="</p>",i+="</dd>",i+='<div id="tips" class="coperate">',s.c_uid==labUser.uid?(i+='<div class="content"></span><span class="delete">删除</span></div>',i+='<div class="arrow_down"></div>'):(i+='<div class="content"><span class="reply">回复</span></div>',i+='<div class="arrow_down"></div>'),i+="</div>",i+='<div class="clearfix"></div>',i+="</dl>";else if("flower"==s.form)i+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',i+='<dt><img alt="" src="'+s.avatar+'"></dt>',i+='<dd  class="contentDd">',i+='<p class="name">'+s.c_nickname+"</p>",i+='<p class="comment">'+s.content+"</p>",i+="</dd>",i+="<dd>",i+='<p class="intro"><span class="l">'+s.created_at+"</span>",i+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",i+="</p>",i+="</dd>",i+='<div class="clearfix"></div>',i+="</dl>";else if("reward"==s.form)i+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',i+='<dt><img alt="" src="'+s.avatar+'"></dt>',i+='<dd  class="contentDd">',i+='<p class="name">'+s.c_nickname+"</p>",i+='<div class="comment reward">'+s.content+'<span class="awardflag"></span></div>',i+="</dd>",i+="<dd>",i+='<p class="intro"><span class="l">'+s.created_at+"</span>",i+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",i+="</p>",i+="</dd>",i+='<div class="clearfix"></div>',i+="</dl>";else if("brand"==s.form){if(i+='<dl data-commentuid = "'+s.c_uid+'" data-commentid = "'+s.id+'" data-zan="'+s.is_zhan+'">',i+='<dt><img alt="" src="'+s.avatar+'"></dt>',i+='<dd  class="contentDd">',i+='<p class="name">'+s.c_nickname+"</p>",null==s.pId){var n="";i+='<p class="comment">成功购买了 <span class="colorf63">'+s.brand_good.goods_title+"</span></p>",i+='<section class="brandcontain nomp" style="position:relative;">',i+='<div class="brandcontent">',i+='<img src="'+s.brand_good.logo+'" alt="">',i+='<div class="branddetail f12" style="position:absolute;">',i+='<p class="f14"><span>'+cutString(s.brand_good.name,10)+'</span><span class="color666">【'+s.brand_good.zone_name+"】</span></p>",i+="<p>",i+='<em class="brand-sort">'+s.brand_good.category_name+'</em> <span class="brand-st pl05">'+s.brand_good.investment_min+" 万元 - "+s.brand_good.investment_max+" 万元</span>",i+="</p>",i+='<p class="brand-keyword">',s.brand_good.keywords.length>0&&($.each(s.brand_good.keywords,function(a,s){n+="<span>"+s+"</span>"}),i+=n),i+="</p>",i+="</div>",i+='<div class="clearfix"></div>',i+="</div>",i+="</section>"}i+="</dd>",i+="<dd>",i+='<p class="intro"><span class="l">'+s.created_at+"</span>",i+=1==s.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+s.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+s.likes+"</em></span>",i+="</p>",i+="</dd>",i+='<div id="tips" class="coperate">',s.c_uid==labUser.uid?(i+='<div class="content"></span><span class="delete">删除</span></div>',i+='<div class="arrow_down"></div>'):(i+='<div class="content"><span class="reply">回复</span></div>',i+='<div class="arrow_down"></div>'),i+="</div>",i+='<div class="clearfix"></div>',i+="</dl>"}}),$("#amazeComment").append(t),$("#allComment").append(i)}else a.data.length<1}function freshList(a){if(a.all_count>0?($("#nocommenttip").addClass("none"),$("#allComment").removeClass("none"),$("#plun").html(a.all_count+"次"),$("#commentnum").html(a.all_count)):($("#nocommenttip").removeClass("none"),$("#allComment").addClass("none")),a.data.length>0){$("#commentflag").data("maxid",a.max_id);var s="";$.each(a.data,function(a,n){if("all"==n.type)if("normal"==n.form)s+='<dl data-commentuid = "'+n.c_uid+'" data-commentid = "'+n.id+'" data-zan="'+n.is_zhan+'">',s+='<dt><img alt="" src="'+n.avatar+'"></dt>',s+='<dd  class="contentDd">',s+='<p class="name">'+n.c_nickname+"</p>",null==n.pId&&(s+='<p class="comment">'+entitiestoUtf16(n.content)+"</p>",n.images.length>0&&(s+='<div class="pics">',$.each(n.images,function(a,n){s+='<img src="'+n+'" alt="" class="onimgs" data-picindex="'+a+'">'}),s+="</div>")),s+="</dd>",s+="<dd>",s+='<p class="intro"><span class="l">'+n.created_at+"</span>",s+=1==n.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+n.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+n.likes+"</em></span>",s+="</p>",s+="</dd>",s+='<div id="tips" class="coperate">',n.c_uid==labUser.uid?(s+='<div class="content"></span><span class="delete">删除</span></div>',s+='<div class="arrow_down"></div>'):(s+='<div class="content"><span class="reply">回复</span></div>',s+='<div class="arrow_down"></div>'),s+="</div>",s+='<div class="clearfix"></div>',s+="</dl>";else if("flower"==n.form)s+='<dl data-commentuid = "'+n.c_uid+'" data-commentid = "'+n.id+'" data-zan="'+n.is_zhan+'">',s+='<dt><img alt="" src="'+n.avatar+'"></dt>',s+='<dd  class="contentDd">',s+='<p class="name">'+n.c_nickname+"</p>",s+='<p class="comment">'+n.content+"</p>",s+="</dd>",s+="<dd>",s+='<p class="intro"><span class="l">'+n.created_at+"</span>",s+=1==n.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+n.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+n.likes+"</em></span>",s+="</p>",s+="</dd>",s+='<div class="clearfix"></div>',s+="</dl>";else if("reward"==n.form)s+='<dl data-commentuid = "'+n.c_uid+'" data-commentid = "'+n.id+'" data-zan="'+n.is_zhan+'">',s+='<dt><img alt="" src="'+n.avatar+'"></dt>',s+='<dd  class="contentDd">',s+='<p class="name">'+n.c_nickname+"</p>",s+='<div class="comment reward">'+n.content+'<span class="awardflag"></span></div>',s+="</dd>",s+="<dd>",s+='<p class="intro"><span class="l">'+n.created_at+"</span>",s+=1==n.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+n.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+n.likes+"</em></span>",s+="</p>",s+="</dd>",s+='<div class="clearfix"></div>',s+="</dl>";else if("brand"==n.form){if(s+='<dl data-commentuid = "'+n.c_uid+'" data-commentid = "'+n.id+'" data-zan="'+n.is_zhan+'">',s+='<dt><img alt="" src="'+n.avatar+'"></dt>',s+='<dd  class="contentDd">',s+='<p class="name">'+n.c_nickname+"</p>",null==n.pId){var e="";s+='<p class="comment">成功购买了 <span class="colorf63">'+n.brand_good.goods_title+"</span></p>",s+='<section class="brandcontain nomp" style="position:relative;">',s+='<div class="brandcontent">',s+='<img src="'+n.brand_good.logo+'" alt="">',s+='<div class="branddetail f12" style="position:absolute;">',s+='<p class="f14"><span>'+cutString(n.brand_good.name,10)+'</span><span class="color666">【'+n.brand_good.zone_name+"】</span></p>",s+="<p>",s+='<em class="brand-sort">'+n.brand_good.category_name+'</em> <span class="brand-st pl05">'+n.brand_good.investment_min+" 万元 - "+n.brand_good.investment_max+" 万元</span>",s+="</p>",s+='<p class="brand-keyword">',n.brand_good.keywords.length>0&&($.each(n.brand_good.keywords,function(a,s){e+="<span>"+s+"</span>"}),s+=e),s+="</p>",s+="</div>",s+='<div class="clearfix"></div>',s+="</div>",s+="</section>"}s+="</dd>",s+="<dd>",s+='<p class="intro"><span class="l">'+n.created_at+"</span>",s+=1==n.is_zhan?'<span class="r JS_zan"><i class="greenzan"></i><em class="num">'+n.likes+"</em></span>":'<span class="r JS_zan"><i class="zan"></i><em class="num">'+n.likes+"</em></span>",s+="</p>",s+="</dd>",s+='<div id="tips" class="coperate">',n.c_uid==labUser.uid?(s+='<div class="content"></span><span class="delete">删除</span></div>',s+='<div class="arrow_down"></div>'):(s+='<div class="content"><span class="reply">回复</span></div>',s+='<div class="arrow_down"></div>'),s+="</div>",s+='<div class="clearfix"></div>',s+="</dl>"}}),$("#allComment").prepend(s)}}function addCommentHtml(a){var s="";s+='<dl data-commentuid = "'+labUser.uid+'" data-commentid = "'+a.id+'" data-zan = "0">',s+='<dt><img alt="" src="'+labUser.avatar+'"></dt>',s+='<dd  class="contentDd">',s+=0==labUser.uid?'<p class="name">'+a.nickname+"</p>":'<p class="name">'+labUser.nickname+"</p>",s+='<p class="comment">'+a.content+"</p>",s+="</dd>",s+="<dd>",s+='<p class="intro"><span class="l">'+unix_to_datetime(a.created_at)+'</span><span class="r JS_zan"><i class="zan"></i><em class="num">0</em></span></p>',s+="</dd>",s+='<div id="tips" class="coperate">',s+='<div class="content"></span><span class="delete">删除</span></div>',s+='<div class="arrow_down"></div>',s+="</div>",s+='<div class="clearfix"></div>',s+="</dl>",$("#allComment").prepend(s).show()}function replyCommentHtml(a,s){var n="";n+='<dl data-commentuid = "'+labUser.uid+'" data-commentid = "'+a.id+'" data-zan = "0">',n+='<dt><img alt="" src="'+labUser.avatar+'"></dt>',n+='<dd  class="contentDd">',n+='<p class="name">'+labUser.nickname+"</p>",n+='<p class="comment">回复<span class="blue">@'+s.p_nickname+"</span>:"+a.content+"</p>",n+='<p class="original"><span class="dark_gray">'+s.p_nickname+":</span>"+s.pContent+"</p>",n+="</dd>",n+="<dd>",n+='<p class="intro"><span class="l">'+unix_to_datetime(a.created_at)+'</span><span class="r JS_zan"><i class="zan"></i><em class="num">0</em></span></p>',n+="</dd>",n+='<div id="tips" class="coperate">',n+='<div class="content"></span><span class="delete">删除</span></div>',n+='<div class="arrow_down"></div>',n+="</div>",n+="</div>",n+='<div class="clearfix"></div>',n+="</dl>",$("#allComment").prepend(n).show()}function addnum(a){var s=++a;s>0?($("#nocommenttip").hide(),$(".allComment,#allComment").show(),$(".allComment .num").text(s)):$("#nocommenttip").show()}function deletenum(a){var s=--a;s>0?($("#nocommenttip").hide(),$(".allComment .num").html(s)):($(".allComment,#allComment").hide(),$(".allComment .num").text(0),$("#nocommenttip").show())}var inapp=window.location.href.indexOf("is_share")<0,args=getQueryStringArgs(),s_id=args.uid||"0",Comment={getCommentList:function(a,s,n){if(s){var e={};e.page=a.page,e.page_size=a.page_size,e.uid=a.uid,e.id=a.id,e.type=a.commentType,e.section=a.section;var t=labUser.api_path+"/comment/list";ajaxRequest(e,t,function(e){e.status?($(".amazeComment .num").html("0"),$(".allComment .num").html("0"),$("#amazeComment").empty(),$("#allComment").empty(),$("#pullUp").data("pagenow",1),getComment(e.message,a.page_size,n,s),isiOS||isAndroid?$(".onimgs").on("click",function(){var a=$(this).data("picindex"),s=$(this).parent().children("img"),n=[];$.each(s,function(s,e){var t={url:$(this).attr("src"),selected:0};$(this).data("picindex")==a&&(t.selected=1),n.push(t)});var e=JSON.stringify(n);lookBigPhoto(e)}):$(".onimgs").on("click",function(){$("#showimg").attr("src",$(this).attr("src")),$("#bigimg").removeClass("none"),$("#bigimg").one("click",function(){$("#bigimg").addClass("none")})})):0==e.message.all_count?$("#nocommenttip").show():$("#nocommenttip").hide()})}else{var e={};e.page=a.page,e.page_size=a.page_size,e.uid=a.uid,e.id=a.id,e.type=a.commentType;var t=labUser.api_path+"/comment/list";ajaxRequest(e,t,function(t){t.status&&($("#pullUp").data("pagenow",e.page),getComment(t.message,a.page_size,n,s),isiOS||isAndroid?$(".onimgs").on("click",function(){var a=$(this).data("picindex"),s=$(this).parent().children("img"),n=[];$.each(s,function(s,e){var t={url:$(this).attr("src"),selected:0};$(this).data("picindex")==a&&(t.selected=1),n.push(t)});var e=JSON.stringify(n);lookBigPhoto(e)}):$(".onimgs").on("click",function(){$("#showimg").attr("src",$(this).attr("src")),$("#bigimg").removeClass("none"),$("#bigimg").one("click",function(){$("#bigimg").addClass("none")})}))})}},getFreshList:function(a){var s={};s.type=a.type,s.uid=a.uid,s.id=a.id,s.fromId=a.fromId,s.update=a.update,s.fecthSize=a.fecthSize;var n=labUser.api_path+"/comment/fresh-list";ajaxRequest(s,n,function(a){a.status&&(freshList(a.message),$("#scroller").css("top","0"),isiOS||isAndroid?$(".onimgs").on("click",function(){var a=$(this).data("picindex"),s=$(this).parent().children("img"),n=[];$.each(s,function(s,e){var t={url:$(this).attr("src"),selected:0};$(this).data("picindex")==a&&(t.selected=1),n.push(t)});var e=JSON.stringify(n);lookBigPhoto(e)}):$(".onimgs").on("click",function(){$("#showimg").attr("src",$(this).attr("src")),$("#bigimg").removeClass("none"),$("#bigimg").one("click",function(){$("#bigimg").addClass("none")})}))})},addComment:function(a,s){var n={};n.uid=a.uid,n.type=a.commentType,n.post_id=a.id,n.content=a.content,"yes"==s?(n.upid=a.upid,n.p_nickname=a.p_nickname,n.pContent=a.pContent):(n.upid="",n.p_nickname="",n.pContent="");var e=labUser.api_path+"/comment/add";ajaxRequest(n,e,function(s){if(s.status){if("Live"==a.commentType){var n={type:a.type,uid:a.uid,id:a.id,fromId:$("#commentflag").data("maxid"),update:"new",fecthSize:0};Comment.getFreshList(n),$("#subcomments").css("backgroundColor","#999")}else Comment.getCommentList(a,"reload");$("#subcomments").data("replay","no")}})},deleteComment:function(a){var s={};s.uid=a.uid,s.id=a.commentid;var n=labUser.api_path+"/comment/delete";ajaxRequest(s,n,function(a){});var e=$(".allComment .num").text();deletenum(e)},zan:function(a,s){var n={};n.uid=s_id,n.id=a,n.type=s;var e=labUser.api_path+"/comment/zhan";ajaxRequest(n,e,function(a){})}};inapp&&s_id>0&&$(document).on("click",".JS_zan",function(){var a,s=parseInt($(this).children(".num").text()),n=$(this).parents("dl").data("commentid"),e=$(this).parents("dl").data("zan");1==e?$(this).addClass("flag"):$(this).removeClass("flag"),$(this).hasClass("flag")?($(this).removeClass("flag"),s-=1,a=0,e=0,$(this).children(".zan").removeClass("greenzan")):($(this).addClass("flag"),s+=1,a=1,e=1,$(this).children(".zan").addClass("greenzan")),$(this).children(".num").text(s),$(this).parents("dl").attr("data-zan",e),Comment.zan(n,a)});